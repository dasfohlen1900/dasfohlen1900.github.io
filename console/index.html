<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Mini.Office – Programmierkonsole</title>
<style>
body{background:#eef4fb;font-family:Segoe UI,Arial,sans-serif;margin:0;padding:20px;}
h1{margin-top:0;text-align:center;}
#editor{width:100%;height:160px;font-family:Consolas,monospace;font-size:15px;padding:10px;}
#run{padding:8px 16px;font-size:16px;margin-top:8px;}
#output{background:#fff;border:1px solid #ccc;padding:10px;margin-top:15px;height:180px;overflow:auto;white-space:pre-wrap;}
.varlist{margin-top:8px;background:#f0f0f0;padding:6px;border-radius:6px;}
</style>
</head>
<body>

<h1>Mini.Office – MOL-Konsole</h1>

<textarea id="editor" placeholder=">>> MOL-Code hier eingeben …"></textarea><br>
<button id="run">Ausführen</button>

<div id="output">Ergebnis wird hier angezeigt…</div>
<div class="varlist" id="vars"></div>

<script>
const out=document.getElementById('output');
const varsBox=document.getElementById('vars');

function interpret(code){
  out.textContent="";
  const vars={};
  const lines=code.split(/\r?\n/).map(l=>l.trim()).filter(l=>l);

  for(let line of lines){
    // Variablen-Setup:  variablen [Var1; Var2]
    if(/^variablen\s*\[/.test(line)){
      const m=line.match(/\[(.*?)\]/);
      if(m){
        m[1].split(/;/).forEach(v=>{
          const name=v.trim();
          if(name) vars[name]=null;
        });
        out.textContent+="Variablen angelegt: "+Object.keys(vars).join(", ")+"\n";
      }
    }

    // Wertzuweisung:  bei.run\variable1[50]
    else if(/^bei\.run/.test(line)){
      const m=line.match(/run\\(\w+)\[(.*?)\]/);
      if(m){
        const name=m[1];
        const value=m[2];
        if(name in vars){
          vars[name]=value;
          out.textContent+=`→ ${name} = ${value}\n`;
        }else{
          out.textContent+=`⚠️ Variable ${name} nicht definiert\n`;
        }
      }
    }

    // sonst ausgeben
    else{
      out.textContent+=`(ignoriert) ${line}\n`;
    }
  }

  // Variablenübersicht
  varsBox.innerHTML="<b>Aktuelle Variablen:</b><br>"+(
    Object.keys(vars).length
      ? Object.entries(vars).map(([k,v])=>`${k} = ${v??'null'}`).join("<br>")
      : "(keine)"
  );
}

document.getElementById('run').onclick=()=>{
  interpret(document.getElementById('editor').value);
};
</script>
</body>
</html>
