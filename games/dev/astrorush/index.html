<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Astro‚ÄëRush ‚Äî Umfangreiches HTML‚ÄëGame</title>
  <style>
    /* Farbpalette des Nutzers: schwarz, wei√ü, gr√ºn */
    :root{
      --bg:#0b0f14;     /* sehr dunkel */
      --panel:#071019;
      --accent:#00b159; /* gr√ºn */
      --muted:#cbd5d9;  /* hellgrau */
      --danger:#ff4d4f;
      --glass: rgba(255,255,255,0.04);
      --font: 'Segoe UI', Roboto, Arial, sans-serif;
    }

    html,body{height:100%;margin:0;font-family:var(--font);background:linear-gradient(180deg,var(--bg),#061018);color:var(--muted);}
    .app{display:grid;grid-template-columns:1fr 360px;gap:18px;padding:18px;box-sizing:border-box;height:100vh}
    @media(max-width:1000px){.app{grid-template-columns:1fr;padding:12px} .sidebar{display:none}}

    /* Canvas container */
    .game-wrap{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);border-radius:12px;padding:12px;display:flex;flex-direction:column;gap:8px;box-shadow:0 6px 30px rgba(0,0,0,0.6)}
    #gameCanvas{background:radial-gradient(circle at 20% 10%, rgba(0,177,89,0.04), transparent 20%), linear-gradient(180deg,#001218 0%, #000812 100%);border-radius:8px;width:100%;height:calc(100vh - 130px);display:block}

    /* Sidebar */
    .sidebar{background:var(--panel);padding:12px;border-radius:12px;color:var(--muted);height:calc(100vh - 36px);overflow:auto}
    .panel{background:var(--glass);padding:10px;border-radius:10px;margin-bottom:10px}
    h1{margin:0 0 6px 0;font-size:18px;color:var(--muted)}
    p.small{font-size:13px;color:#9fb0b9;margin:6px 0}

    .btn{display:inline-block;padding:8px 12px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.06);cursor:pointer;font-weight:600}
    .btn.accent{background:linear-gradient(90deg,var(--accent),#00e07a);color:#00110a;border:0}
    .controls{display:flex;gap:8px;flex-wrap:wrap}

    .stat{display:flex;justify-content:space-between;padding:8px 6px}
    .stat strong{color:white}

    footer{font-size:12px;color:#8da0a8;margin-top:6px;text-align:center}

    /* HUD overlay */
    .hud{position:absolute;left:22px;top:22px;background:rgba(0,0,0,0.25);backdrop-filter: blur(4px);padding:8px 12px;border-radius:10px;color:var(--muted);display:flex;gap:12px;align-items:center}
    .hud .score{font-size:16px;font-weight:700;color:var(--accent)}

    /* small form elements */
    label{display:block;font-size:13px;margin-bottom:6px;color:#9fb0b9}
    input[type=range]{width:100%}
    .row{display:flex;gap:8px}
    .muted{color:#8f9ca3;font-size:13px}
    .logo{font-weight:800;color:var(--accent);letter-spacing:1px}

    /* Pause overlay */
    .overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;pointer-events:none}
    .overlay .card{pointer-events:auto;background:linear-gradient(180deg,rgba(255,255,255,0.03),rgba(255,255,255,0.01));padding:22px;border-radius:12px;text-align:center}
  </style>
</head>
<body>
  <div class="app">
    <div class="game-wrap" role="main">
      <div style="position:relative">
        <div class="hud" aria-hidden="false">
          <div class="logo">ASTRO‚ÄëRUSH</div>
          <div class="score">Punkte: <span id="hudScore">0</span></div>
          <div class="muted">Leben: <span id="hudLives">3</span></div>
        </div>
        <canvas id="gameCanvas" width="1280" height="720" aria-label="Spielbereich"></canvas>
        <div id="overlay" class="overlay" style="display:none">
          <div class="card" role="dialog" aria-modal="true">
            <h2 id="overlayTitle">Pause</h2>
            <p id="overlayText">Dr√ºcke [P] zum Fortsetzen oder w√§hle unten.</p>
            <div style="display:flex;gap:8px;justify-content:center;margin-top:10px">
              <button class="btn" id="btnResume">Fortsetzen</button>
              <button class="btn" id="btnRestart">Neustart</button>
            </div>
          </div>
        </div>
      </div>
      <div style="display:flex;gap:10px;align-items:center;justify-content:space-between">
        <div class="controls">
          <button id="startBtn" class="btn accent">Start</button>
          <button id="pauseBtn" class="btn">Pause (P)</button>
          <button id="muteBtn" class="btn">üîä Ton</button>
        </div>
        <div class="muted">Tip: Pfeiltasten oder WASD bewegen ‚Äî Leertaste schie√üen</div>
      </div>
    </div>

    <aside class="sidebar" aria-label="Seitenleiste">
      <div class="panel">
        <h1>Spielinformationen</h1>
        <p class="small">Astro‚ÄëRush ist ein Canvas‚ÄëArcade‚ÄëSpiel mit mehreren Levels, Power‚ÄëUps und lokalem Highscore. Es ist responsiv und funktioniert auf Desktop & Mobil (Touchsteuerung).</p>
        <div class="stat"><span>Aktuelles Level</span><strong id="sideLevel">1</strong></div>
        <div class="stat"><span>Highscore</span><strong id="sideHighscore">0</strong></div>
      </div>

      <div class="panel">
        <h1>Einstellungen</h1>
        <label for="difficulty">Schwierigkeit</label>
        <select id="difficulty" aria-label="Schwierigkeit">
          <option value="easy">Einfach</option>
          <option value="normal" selected>Normal</option>
          <option value="hard">Schwer</option>
        </select>

        <label for="volume">Lautst√§rke</label>
        <input id="volume" type="range" min="0" max="1" step="0.01" value="0.6">

        <div style="margin-top:8px;display:flex;gap:8px">
          <button id="resetHighscore" class="btn">Highscore l√∂schen</button>
          <button id="exportState" class="btn">Speichern(.json)</button>
        </div>
      </div>

      <div class="panel">
        <h1>Kontrollen</h1>
        <p class="small">Desktop:</p>
        <ul>
          <li>Links/Rechts oder A/D ‚Äî bewegen</li>
          <li>Leertaste ‚Äî Schuss</li>
          <li>P ‚Äî Pause</li>
        </ul>
        <p class="small">Mobil:</p>
        <p class="small">Ber√ºhre links/rechts der Leinwand zum Steuern. Tippe unten rechts zum Schie√üen.</p>
      </div>

      <div class="panel">
        <h1>Tipps & Tricks</h1>
        <p class="small">Sammle gr√ºne Power‚ÄëOrbs f√ºr Extra‚ÄëFeuerkraft. Vermeide rote Meteoriten ‚Äî sie machen viel Schaden.</p>
      </div>

      <footer>Erstellt mit ‚ù§Ô∏è ‚Äî sag mir, wenn du √Ñnderungen willst.</footer>
    </aside>
  </div>

  <script>
  // Umfangreiches HTML-Canvas-Game: Astro-Rush
  // Hauptfeatures:
  // - Canvas-Rendering, adaptive Aufl√∂sung
  // - Spieler Schiff mit Bewegung & Schuss
  // - Gegner (Asteroiden) mit verschiedenen Typen
  // - Power-Ups, Partikel-Effekte
  // - Level-Progression, Lives, Punkte
  // - Highscore in localStorage
  // - Toneffekte (WebAudio) & Lautst√§rke-Regler
  // - Touch-Controls

  (function(){
    // --- Utility & Setup ---
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    let cw = canvas.width, ch = canvas.height;
    const hudScore = document.getElementById('hudScore');
    const hudLives = document.getElementById('hudLives');
    const sideLevel = document.getElementById('sideLevel');
    const sideHighscore = document.getElementById('sideHighscore');

    // State
    const state = {
      running:false,
      paused:false,
      score:0,
      lives:3,
      level:1,
      highscore: parseInt(localStorage.getItem('astro_highscore')||'0',10),
      difficulty:'normal',
      volume:0.6
    };

    sideHighscore.textContent = state.highscore;
    hudScore.textContent = state.score;
    hudLives.textContent = state.lives;

    // Responsive canvas: fit to container while keeping aspect ratio
    function resize(){
      const rect = canvas.getBoundingClientRect();
      const ratio = 16/9;
      let w = rect.width, h = rect.height;
      // compute pixel size
      canvas.width = Math.max(640, Math.floor(w));
      canvas.height = Math.max(360, Math.floor(h));
      cw = canvas.width; ch = canvas.height;
    }
    window.addEventListener('resize', resize);
    resize();

    // --- Input ---
    const keys = {};
    window.addEventListener('keydown', e=>{keys[e.key.toLowerCase()] = true; if(e.key===' '){e.preventDefault();}});
    window.addEventListener('keyup', e=>{keys[e.key.toLowerCase()] = false;});

    // Touch controls
    let touchLeft=false, touchRight=false, touchFire=false;
    canvas.addEventListener('touchstart', e=>{
      e.preventDefault();
      const t = e.touches[0];
      const x = t.clientX - canvas.getBoundingClientRect().left;
      if(x < canvas.width*0.4) touchLeft=true;
      else if(x > canvas.width*0.6) touchRight=true;
      else touchFire=true;
    }, {passive:false});
    canvas.addEventListener('touchend', e=>{ touchLeft=touchRight=touchFire=false; }, {passive:false});

    // Buttons
    document.getElementById('startBtn').addEventListener('click', ()=>{startGame()});
    document.getElementById('pauseBtn').addEventListener('click', togglePause);
    document.getElementById('btnResume').addEventListener('click', ()=>{togglePause(false)});
    document.getElementById('btnRestart').addEventListener('click', ()=>{resetGame(); startGame()});
    document.getElementById('muteBtn').addEventListener('click', toggleMute);

    document.getElementById('difficulty').addEventListener('change', e=>{state.difficulty = e.target.value});
    const volumeInput = document.getElementById('volume');
    volumeInput.addEventListener('input', e=>{state.volume = parseFloat(e.target.value); setVolume(state.volume)});

    document.getElementById('resetHighscore').addEventListener('click', ()=>{localStorage.removeItem('astro_highscore'); state.highscore=0; sideHighscore.textContent=0; alert('Highscore gel√∂scht')});
    document.getElementById('exportState').addEventListener('click', ()=>{
      const payload = JSON.stringify({score:state.score,highscore:state.highscore,level:state.level});
      const blob = new Blob([payload],{type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href=url; a.download='astro_state.json'; a.click(); URL.revokeObjectURL(url);
    });

    // Keyboard shortcuts
    window.addEventListener('keydown', e=>{
      if(e.key.toLowerCase()==='p') togglePause();
      if(e.key.toLowerCase()==='r') resetGame();
    });

    // --- Sound (simple) ---
    const AudioCtx = window.AudioContext || window.webkitAudioContext;
    const audioCtx = AudioCtx ? new AudioCtx() : null;
    let muted = false;
    function playTone(freq=440, duration=0.08, type='sine'){ if(!audioCtx || muted) return; const now=audioCtx.currentTime; const o=audioCtx.createOscillator(); const g=audioCtx.createGain(); o.type=type; o.frequency.value=freq; g.gain.value=state.volume; o.connect(g); g.connect(audioCtx.destination); o.start(now); o.stop(now+duration); }
    function setVolume(v){ if(audioCtx) audioCtx.destination.gain && (audioCtx.destination.gain.value=v); }
    function toggleMute(){ muted = !muted; document.getElementById('muteBtn').textContent = muted ? 'üîá Stumm' : 'üîä Ton'; }

    // --- Game Objects ---
    class Player{
      constructor(){
        this.w = 36; this.h = 24;
        this.x = cw/2; this.y = ch - 90;
        this.speed = 6; this.cooldown = 0; this.color = '#00ff9d';
        this.power = 1; this.invuln = 0;
      }
      update(){
        // movement
        let mv = 0;
        if(keys['arrowleft']||keys['a']||touchLeft) mv = -1;
        if(keys['arrowright']||keys['d']||touchRight) mv = 1;
        this.x += mv * this.speed;
        // clamp
        this.x = Math.max(this.w/2, Math.min(cw - this.w/2, this.x));
        // fire
        this.cooldown = Math.max(0, this.cooldown - 1);
        const firePressed = keys[' ']|0 || touchFire;
        if((keys[' '] || touchFire) && this.cooldown===0){ this.fire(); this.cooldown = Math.max(10, 24 - this.power*4); }
        if(this.invuln>0) this.invuln--;
      }
      fire(){
        const shots = this.power>1 ? Math.min(3, this.power) : 1;
        for(let i=0;i<shots;i++){
          const spread = (i-(shots-1)/2)*6;
          const b = new Bullet(this.x + spread, this.y - 20, -8, 8);
          bullets.push(b);
        }
        playTone(900,0.04,'square');
      }
      draw(){
        // simple ship shape
        ctx.save();
        ctx.translate(this.x,this.y);
        if(this.invuln%20 < 10) ctx.globalAlpha = 0.6;
        ctx.fillStyle = 'white';
        ctx.beginPath();
        ctx.moveTo(0,-this.h/2);
        ctx.lineTo(this.w/2,this.h/2);
        ctx.lineTo(0,this.h/4);
        ctx.lineTo(-this.w/2,this.h/2);
        ctx.closePath();
        ctx.fill();
        ctx.fillStyle = 'rgba(0,177,89,0.9)';
        ctx.fillRect(-6, this.h/4, 12, 6); // engine
        ctx.restore();
      }
    }

    class Bullet{
      constructor(x,y,vy,damage){ this.x=x;this.y=y;this.vy=vy;this.r=4;this.damage=damage||1; }
      update(){ this.y += this.vy; }
      draw(){ ctx.beginPath(); ctx.fillStyle='white'; ctx.arc(this.x,this.y,this.r,0,Math.PI*2); ctx.fill(); }
    }

    class Asteroid{
      constructor(x,y,sz,spd,hp,color){ this.x=x;this.y=y;this.sz=sz;this.spd=spd;this.hp=hp;this.color=color||'#7a7a7a'; this.rot = Math.random()*Math.PI*2; this.rvel = (Math.random()-0.5)*0.02; }
      update(){ this.y += this.spd; this.rot += this.rvel; }
      draw(){ ctx.save(); ctx.translate(this.x,this.y); ctx.rotate(this.rot);
        ctx.fillStyle=this.color; ctx.beginPath(); ctx.moveTo(0,-this.sz);
        for(let i=0;i<8;i++){ const a = i/8*Math.PI*2; const rr = this.sz*(0.75+Math.random()*0.5); ctx.lineTo(Math.cos(a)*rr, Math.sin(a)*rr); }
        ctx.closePath(); ctx.fill(); ctx.restore(); }
    }

    class PowerUp{ constructor(x,y,type){ this.x=x;this.y=y;this.type=type; this.r=12; } update(){ this.y += 2; } draw(){ ctx.beginPath(); ctx.fillStyle = this.type==='power'?'#00e07a':'#ffd36b'; ctx.arc(this.x,this.y,this.r,0,Math.PI*2); ctx.fill(); } }

    // Particles
    const particles = [];
    function spawnParticles(x,y,count,color){ for(let i=0;i<count;i++){ particles.push({x,y,vx:(Math.random()-0.5)*6,vy:(Math.random()-0.5)*6,life:30+Math.random()*40,color}); } }
    function updateParticles(){ for(let i=particles.length-1;i>=0;i--){ const p=particles[i]; p.x+=p.vx; p.y+=p.vy; p.vy+=0.12; p.life--; if(p.life<=0) particles.splice(i,1);} }
    function drawParticles(){ for(const p of particles){ ctx.globalAlpha = Math.max(0, p.life/60); ctx.fillStyle = p.color; ctx.fillRect(p.x,p.y,2,2); } ctx.globalAlpha=1; }

    // Game arrays
    const bullets = []; const asteroids = []; const powerups = [];
    let player = new Player();

    // Spawn logic
    let spawnTimer=0; function spawnAsteroids(){ spawnTimer--; if(spawnTimer>0) return; const count = 1 + Math.floor(Math.random()* (state.level + (state.difficulty==='hard'?2:0)) ); for(let i=0;i<count;i++){ const x = 40 + Math.random()*(cw-80); const y = -40 - Math.random()*200; const sz = 18 + Math.random()*36 + state.level*4; const spd = 1 + Math.random()* (1 + state.level*0.15); const hp = Math.max(1, Math.floor(sz/18)); const col = Math.random()<0.1 ? '#ff4d4f' : '#7a7a7a'; asteroids.push(new Asteroid(x,y,sz,spd,hp,col)); }
      spawnTimer = Math.max(20, 100 - state.level*6);
    }

    // Collision helpers
    function dist(a,b){ const dx=a.x-b.x, dy=a.y-b.y; return Math.sqrt(dx*dx+dy*dy); }

    // --- Game Loop & Mechanics ---
    let last = 0;
    function loop(ts=0){ if(!state.running) return; const dt = Math.min(40, ts-last); last = ts; if(!state.paused) update(); render(); requestAnimationFrame(loop); }

    function update(){
      player.update();
      // bullets
      for(let i=bullets.length-1;i>=0;i--){ bullets[i].update(); if(bullets[i].y < -20) bullets.splice(i,1); }
      // asteroids
      for(let i=asteroids.length-1;i>=0;i--){ const a=asteroids[i]; a.update(); if(a.y > ch + 100){ asteroids.splice(i,1); continue; }
        // collision with player
        if(player.invuln===0 && dist(player,a) < a.sz/1.2 + 16){ // hit
          spawnParticles(player.x, player.y, 20, '#ff944d'); playTone(120,0.12,'sawtooth'); state.lives--; player.invuln = 120; hudLives.textContent = state.lives; if(state.lives<=0){ gameOver(); return; }
          asteroids.splice(i,1); continue;
        }
        // bullets
        for(let j=bullets.length-1;j>=0;j--){ const b=bullets[j]; if(dist(b,a) < a.sz/1.2){ a.hp -= b.damage; bullets.splice(j,1); spawnParticles(b.x,b.y,6,'#fff'); if(a.hp<=0){ // destroyed
              state.score += Math.floor(a.sz*1.7);
              hudScore.textContent = state.score; spawnParticles(a.x,a.y,30,'#ffcc66');
              if(Math.random()<0.15) powerups.push(new PowerUp(a.x,a.y, Math.random()<0.5 ? 'power' : 'life'));
              asteroids.splice(i,1);
              // level up if enough
              if(state.score > state.level * 250 + state.level*state.level*40) levelUp();
            }
            break;
        }}
      }

      // powerups
      for(let i=powerups.length-1;i>=0;i--){ const p=powerups[i]; p.update(); if(dist(p,player) < 30){ if(p.type==='power'){ player.power = Math.min(3, player.power+1); state.score += 25; } else { state.lives++; hudLives.textContent = state.lives; }
          playTone(600,0.06,'triangle'); powerups.splice(i,1); }
        else if(p.y > ch+50) powerups.splice(i,1);
      }

      updateParticles();
      spawnAsteroids();
    }

    function levelUp(){ state.level++; sideLevel.textContent = state.level; playTone(400,0.2,'sine'); }

    function render(){
      // clear
      ctx.clearRect(0,0,cw,ch);
      // starfield
      drawStarfield();
      // draw objects
      for(const p of particles){} // particles drawn later
      for(const a of asteroids) a.draw();
      for(const b of bullets) b.draw();
      for(const p of powerups) p.draw();
      player.draw();
      drawParticles();
      // hud floating effects
      // TODO: more VFX
    }

    // Starfield
    const stars = [];
    for(let i=0;i<120;i++) stars.push({x:Math.random()*cw,y:Math.random()*ch,r:Math.random()*2+0.3,v:Math.random()*0.3+0.1});
    function drawStarfield(){ ctx.save(); ctx.fillStyle='rgba(255,255,255,0.02)'; ctx.fillRect(0,0,cw,ch); for(const s of stars){ s.y += s.v; if(s.y>ch) s.y=0; ctx.beginPath(); ctx.fillStyle = 'rgba(255,255,255,'+ (0.2 + s.r*0.08) +')'; ctx.arc(s.x,s.y,s.r,0,Math.PI*2); ctx.fill(); } ctx.restore(); }

    // Start / Pause / Reset
    function startGame(){ if(!audioCtx || audioCtx.state==='suspended') try{ audioCtx.resume(); } catch(e){}; state.running=true; state.paused=false; document.getElementById('overlay').style.display='none'; last = performance.now(); requestAnimationFrame(loop); }
    function togglePause(force){ if(typeof force==='boolean') state.paused = !force; else state.paused = !state.paused; document.getElementById('overlay').style.display = state.paused ? 'flex':'none'; state.paused ? (document.getElementById('overlayTitle').textContent='Pause') : null; }
    function resetGame(){ // clear
      state.score=0; state.lives=3; state.level=1; player = new Player(); bullets.length=0; asteroids.length=0; powerups.length=0; particles.length=0; hudScore.textContent = state.score; hudLives.textContent = state.lives; sideLevel.textContent = state.level; }

    function gameOver(){ state.running=false; document.getElementById('overlay').style.display='flex'; document.getElementById('overlayTitle').textContent = 'Game Over'; document.getElementById('overlayText').textContent = `Dein Score: ${state.score}`;
      if(state.score > state.highscore){ state.highscore = state.score; localStorage.setItem('astro_highscore', state.highscore); sideHighscore.textContent = state.highscore; playTone(1400,0.16,'sine'); }
    }

    // init small loop to keep resizing stars
    setInterval(()=>{
      // keep star positions in sync on resize
      for(const s of stars){ s.x = Math.max(0, Math.min(cw, s.x + (Math.random()-0.5)*4)); }
    }, 2000);

    // expose some for dev console
    window.astro = {state, resetGame, startGame, gameOver};

    // auto start
    // resetGame(); startGame(); // commented so user can press Start

    // Accessibility: focus handling
    canvas.setAttribute('tabindex',0);

    // small autosave highscore
    setInterval(()=>{ const hs = parseInt(localStorage.getItem('astro_highscore')||'0',10); if(state.score>hs) localStorage.setItem('astro_highscore',state.score); }, 5000);

    // polish: simple FPS counter optional
    // done
  })();
  </script>
</body>
</html>
