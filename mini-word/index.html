<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mini-Word</title>

<!-- Lokale Fonts -->
<style>
@font-face { font-family: 'Lukovic2'; src: url('assets/fonts/Lukovic2-Regular.ttf'); }
@font-face { font-family: 'LukovicSans'; src: url('assets/fonts/LukovicSans.ttf'); }
@font-face { font-family: 'RetroStylePro'; src: url('assets/fonts/RetroStyleProReg.ttf'); }
@font-face { font-family: 'Bahnschrift'; src: url('assets/fonts/bahnschrift.ttf'); }
@font-face { font-family: 'Calibri'; src: url('assets/fonts/calibri.ttf'); }
@font-face { font-family: 'SegoeUI'; src: url('assets/fonts/segoeui.ttf'); }

/* IcoMoon Icons */
@font-face {
  font-family: 'IcoMoon';
  src: url('fonts/icomoon.woff') format('woff'),
       url('fonts/icomoon.ttf') format('truetype');
  font-weight: normal;
  font-style: normal;
}

body {
  margin: 0;
  font-family: 'Work Sans', 'SegoeUI', sans-serif;
  background: #f7f9fc;
  height: 100vh;
  display: flex;
  flex-direction: column;
}

/* Ribbon */
.ribbon {
  background: linear-gradient(#fdfdfd, #e9edf5);
  border-bottom: 1px solid #c6c9d1;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}
.tabs {
  display: flex;
  border-bottom: 1px solid #ccc;
  padding: 4px 10px;
}
.tab {
  padding: 6px 14px;
  cursor: pointer;
  border-radius: 5px 5px 0 0;
  margin-right: 4px;
  font-weight: 600;
  color: #333;
}
.tab.active {
  background: #fff;
  border: 1px solid #ccc;
  border-bottom: none;
}
.tab-content {
  display: none;
  background: #fff;
  padding: 10px;
  border-top: none;
  min-height: 90px;
}
.tab-content.active { display: block; }

.group {
  display: inline-block;
  vertical-align: top;
  padding: 5px 10px;
  border-right: 1px solid #ddd;
}
.group:last-child { border-right: none; }

button.icon {
  font-family: 'IcoMoon';
  font-size: 20px;
  background: none;
  border: none;
  cursor: pointer;
  margin: 5px;
  transition: background 0.2s;
}
button.icon:hover {
  background: #e6eaf2;
  border-radius: 6px;
}

#editor {
  flex-grow: 1;
  background: white;
  margin: 0;
  padding: 20px;
  outline: none;
  font-size: 16px;
  overflow-y: auto;
}
select, input[type="color"], input[type="file"] {
  margin: 4px;
  padding: 3px;
  border: 1px solid #ccc;
  border-radius: 3px;
  font-family: inherit;
}

/* Export-Buttons */
.save-zone {
  margin-top: 8px;
}

/* Mobile Anpassungen */
body.mobile-smartphone #editor {
  padding-top: 60px;
  font-family: Arial, Verdana, "Times New Roman", sans-serif;
  font-size: 14px;
}
</style>

<link href="https://fonts.googleapis.com/css2?family=Work+Sans&display=swap" rel="stylesheet">
</head>

<body>

<!-- Desktop Ribbon -->
<div class="ribbon">
  <div class="tabs">
    <div class="tab active" data-tab="file">Datei</div>
    <div class="tab" data-tab="home">Start</div>
    <div class="tab" data-tab="insert">Einf√ºgen</div>
    <div class="tab" data-tab="review">√úberpr√ºfen</div>
  </div>

  <!-- Datei -->
  <div class="tab-content active" id="file">
    <div class="group">
      <button class="icon" onclick="newDocument()">&#xe90e;</button> Neu
      <button class="icon" onclick="saveOctxt()">&#xe962;</button> 
      <button class="icon" onclick="loadOctxt()">&#xe930;</button> 
      <button class="icon" onclick="exportDocx()">&#xeae1;</button> 
      <button class="icon" onclick="saveTxt()">TXT</button>
      <button class="icon" onclick="window.print()">&#xe914;</button>
      <input type="file" id="fileInput" hidden>
    </div>
    <div class="save-zone"></div>
  </div>

  <!-- Start -->
  <div class="tab-content" id="home">
    <div class="group">
      <select id="fontSelect"></select>
      <select id="fontSize">
        <option>4</option><option>6</option><option>8</option>
        <option>10</option><option>11</option><option>12</option><option>14</option>
        <option>16</option><option>18</option><option>20</option><option>24</option>
        <option>32</option><option>40</option><option>50</option><option>64</option><option>72</option>
      </select>
    </div>
    <div class="group">
      <button class="icon" onclick="format('bold')">&#xea62;</button>
      <button class="icon" onclick="format('italic')">&#xea64;</button>
      <button class="icon" onclick="format('underline')">&#xea63;</button>
      <input type="color" id="colorPicker" title="Schriftfarbe">
    </div>
    <div class="group">
      <button class="icon" onclick="format('insertUnorderedList')">&#xe9ba;</button>
      <button class="icon" onclick="format('insertOrderedList')">&#xe9b9;</button>
    </div>
    <div class="group">
      <button class="icon" onclick="format('justifyLeft')">&#xea77;</button>
      <button class="icon" onclick="format('justifyCenter')">&#xea78;</button>
      <button class="icon" onclick="format('justifyRight')">&#xea79;</button>
      <button class="icon" onclick="format('justifyFull')">&#xea7a;</button>
    </div>
  </div>

  <!-- Einf√ºgen -->
  <div class="tab-content" id="insert">
    <div class="group">
      <button class="icon" onclick="insertImage()">&#xe90d;</button> Bild
      <button class="icon" onclick="insertTable()">&#xe900;</button> Tabelle
      <button class="icon" onclick="openCharmap()">Œ©</button>
      <script>
      function openCharmap() {
        const popup = window.open('charmap.html', 'Charmap', 'width=400,height=300');
        window.addEventListener('message', function receive(event) {
          if(event.data.type==='insertSymbol'){
            document.execCommand('insertText', false, event.data.symbol);
          }
        }, { once: true });
      }
      </script>
    </div>
  </div>

  <!-- √úberpr√ºfen -->
  <div class="tab-content" id="review">
    <div class="group">
      <button class="icon">&#xea52;</button> Rechtschreibung
      <button class="icon">&#xea53;</button> √Ñnderungen
    </div>
  </div>
</div>

<div id="editor" contenteditable="true">
  <p>üñ§ü§çüíö Willkommen bei <b>Mini-Word Premium</b> ‚Äì dein Editor mit Stil!</p>
</div>

<script>
// === Tabs ---
const tabs = document.querySelectorAll('.tab');
const contents = document.querySelectorAll('.tab-content');
const editor = document.getElementById('editor');
const fileInput = document.getElementById('fileInput');
tabs.forEach(tab => {
  tab.addEventListener('click', () => {
    tabs.forEach(t => t.classList.remove('active'));
    contents.forEach(c => c.classList.remove('active'));
    tab.classList.add('active');
    document.getElementById(tab.dataset.tab).classList.add('active');
  });
});

// === Formatierungen ===
function format(cmd, value=null){ document.execCommand(cmd,false,value); }
document.getElementById('colorPicker').onchange = e => format('foreColor', e.target.value);
document.getElementById('fontSize').onchange = e => format('fontSize', e.target.value);

// Alphabetische Fontliste
const fonts=['Arial','Bahnschrift','Bungee','Calibri','Comic Sans MS','Courier Prime','Exo 2','Fira Code','Georgia','Gloria Hallelujah','JetBrains Mono','Lilita One','Lora','LukovicSans','Lukovic2','Merriweather','Montserrat','Noto Sans','Open Sans','Patrick Hand','Playfair Display','Poppins','PT Serif','Quicksand','Raleway','Roboto','SegoeUI','Shadows Into Light','Signika','Times','Vollkorn','Verdana','Work Sans'].sort();
const fontSelect=document.getElementById('fontSelect');
fonts.forEach(f => { const opt=document.createElement('option'); opt.value=f; opt.textContent=f; fontSelect.appendChild(opt); });
fontSelect.onchange=e=>format('fontName', e.target.value);

// === Bild / Tabelle / Symbol ===
function insertImage(){ const url=prompt("Bild-URL eingeben:"); if(url) document.execCommand('insertImage', false, url); }
function insertTable(){ const rows=parseInt(prompt("Zeilenanzahl:")); const cols=parseInt(prompt("Spaltenanzahl:")); if(!rows||!cols) return; let table="<table border='1' style='border-collapse:collapse;width:100%;'>"; for(let r=0;r<rows;r++){ table+="<tr>"; for(let c=0;c<cols;c++) table+="<td>&nbsp;</td>"; table+="</tr>"; } table+="</table>"; document.execCommand("insertHTML", false, table); }
function insertSymbol(symbol){ document.execCommand("insertText", false, symbol); }

// === Speichern / Laden / Export ===
function newDocument(){
  if(confirm("Neues Dokument erstellen? Alle ungespeicherten √Ñnderungen gehen verloren.")){
    editor.innerHTML="<p></p>";
    localStorage.removeItem('miniword_autosave');
  }
}
function saveOctxt(){ const blob=new Blob([editor.innerHTML],{type:'text/html'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='MiniWord.octxt'; a.click(); }
function loadOctxt(){ fileInput.accept=".octxt,.txt"; fileInput.click(); fileInput.onchange=e=>{ const file=e.target.files[0]; if(!file) return; const reader=new FileReader(); reader.onload=ev=>{ if(file.name.endsWith(".txt")) editor.textContent=ev.target.result; else editor.innerHTML=ev.target.result; localStorage.setItem('miniword_autosave', editor.innerHTML); }; reader.readAsText(file); }; }
function saveTxt(){ const blob=new Blob([editor.textContent],{type:'text/plain'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='MiniWord.txt'; a.click(); }
function exportDocx(){ const header=`<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word'><head><meta charset='utf-8'></head><body>`; const footer=`</body></html>`; const blob=new Blob(['\ufeff', header+editor.innerHTML+footer],{type:'application/msword'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='MiniWord.docx'; a.click(); }

// === Autosave ===
editor.addEventListener('input',()=>{ localStorage.setItem('miniword_autosave', editor.innerHTML); });
window.addEventListener('load',()=>{ const saved=localStorage.getItem('miniword_autosave'); if(saved) editor.innerHTML=saved; });

// === Smartphone-Erkennung & Mobile Toolbar ===
function isSmartphone(){ const ua=navigator.userAgent||navigator.vendor||window.opera; return (/Android/i.test(ua)&&!/Tablet|Tab/i.test(ua))||/iPhone/i.test(ua); }
function initSmartphoneMiniWord(){
  document.body.classList.add('mobile-smartphone');
  const ribbon=document.querySelector('.ribbon'); if(ribbon) ribbon.style.display='none';
  const burger=document.createElement('button'); burger.textContent='‚ò∞'; burger.style.position='fixed'; burger.style.top='10px'; burger.style.left='10px'; burger.style.zIndex='1000'; burger.style.fontSize='24px'; burger.style.background='#fff'; burger.style.border='1px solid #ccc'; burger.style.borderRadius='5px'; burger.style.padding='5px 10px'; document.body.appendChild(burger);
  const menu=document.createElement('div'); menu.style.position='fixed'; menu.style.top='50px'; menu.style.left='10px'; menu.style.background='#fff'; menu.style.border='1px solid #ccc'; menu.style.borderRadius='5px'; menu.style.padding='10px'; menu.style.display='none'; menu.style.zIndex='1000';
  menu.innerHTML=`<button onclick="newDocument()">Neu</button><br><button onclick="saveOctxt()">Speichern</button><br><button onclick="loadOctxt()">Laden</button><br><button onclick="exportDocx()">DOCX</button><br><button onclick="saveTxt()">TXT</button>`;
  document.body.appendChild(menu);
  burger.addEventListener('click',()=>{ menu.style.display=menu.style.display==='none'?'block':'none'; });

  const toolbar=document.createElement('div'); toolbar.style.position='fixed'; toolbar.style.top='0'; toolbar.style.right='0'; toolbar.style.left='60px'; toolbar.style.height='50px'; toolbar.style.background='#f7f9fc'; toolbar.style.borderBottom='1px solid #ccc'; toolbar.style.display='flex'; toolbar.style.alignItems='center'; toolbar.style.padding='0 10px'; toolbar.style.zIndex='999'; toolbar.style.overflowX='auto';
  ['bold','italic','underline','undo','redo'].forEach(cmd=>{ const btn=document.createElement('button'); btn.textContent=cmd[0].toUpperCase(); btn.style.marginRight='5px'; btn.style.fontSize='18px'; btn.onclick=()=>document.execCommand(cmd,false,null); toolbar.appendChild(btn); });
  const colorInput=document.createElement('input'); colorInput.type='color'; colorInput.title='Textfarbe'; colorInput.onchange=e=>document.execCommand('foreColor', false, e.target.value); toolbar.appendChild(colorInput);

  const fontSizes=[4,6,8,10,11,12,14,16,18,20,24,32,40,50,64,72];
  const sizeSelect=document.createElement('select'); fontSizes.forEach(sz=>{ const opt=document.createElement('option'); opt.value=sz; opt.textContent=sz; sizeSelect.appendChild(opt); });
  sizeSelect.onchange=e=>{ const size=e.target.value; const sel=window.getSelection(); if(!sel.rangeCount) return; const range=sel.getRangeAt(0); if(range.collapsed) return; const span=document.createElement('span'); span.style.fontSize=size+'pt'; span.appendChild(range.extractContents()); range.insertNode(span); sel.removeAllRanges(); const newRange=document.createRange(); newRange.setStartAfter(span); sel.addRange(newRange); };
  toolbar.appendChild(sizeSelect);

  const insertSymbolBtn=document.createElement('button'); insertSymbolBtn.textContent='Œ©'; insertSymbolBtn.onclick=()=>{ const sym=prompt("Symbol eingeben:"); if(sym) document.execCommand('insertText', false, sym); }; toolbar.appendChild(insertSymbolBtn);
  const insertImageBtn=document.createElement('button'); insertImageBtn.textContent='üñº'; insertImageBtn.onclick=()=>{ const url=prompt("Bild-URL eingeben:"); if(url) document.execCommand('insertImage', false, url); }; toolbar.appendChild(insertImageBtn);
  const insertTableBtn=document.createElement('button'); insertTableBtn.textContent='‚ò∞T'; insertTableBtn.onclick=()=>{ const rows=parseInt(prompt("Zeilenanzahl:")); const cols=parseInt(prompt("Spaltenanzahl:")); if(!rows||!cols) return; let table="<table border='1' style='border-collapse:collapse;width:100%;'>"; for(let r=0;r<rows;r++){ table+="<tr>"; for(let c=0;c<cols;c++) table+="<td>&nbsp;</td>"; table+="</tr>"; } table+="</table>"; document.execCommand("insertHTML", false, table); }; toolbar.appendChild(insertTableBtn);

  document.body.appendChild(toolbar);
}

window.addEventListener('load',()=>{ if(isSmartphone()) initSmartphoneMiniWord(); });
</script>
</body>
</html>
