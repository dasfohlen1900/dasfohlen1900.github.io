<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mini-Table</title>

<!-- IcoMoon lokal -->
<style>
@font-face { font-family: 'IcoMoon'; src: url('fonts/icomoon.woff'); }

body {
  margin:0;
  font-family:'Work Sans','SegoeUI',sans-serif;
  background:#f7f9fc;
  display:flex;
  flex-direction:column;
  height:100vh;
}

/* Ribbon Styles */
.ribbon {
  background: linear-gradient(#fdfdfd, #e9edf5);
  border-bottom: 1px solid #c6c9d1;
  box-shadow:0 1px 3px rgba(0,0,0,0.1);
}
.tabs { display:flex; border-bottom:1px solid #ccc; padding:4px 10px; }
.tab {
  padding:6px 14px;
  cursor:pointer;
  border-radius:5px 5px 0 0;
  margin-right:4px;
  font-weight:600;
  color:#333;
}
.tab.active { background:#fff; border:1px solid #ccc; border-bottom:none; }
.tab-content { display:none; background:#fff; padding:10px; border-top:none; min-height:90px; }
.tab-content.active { display:block; }
.group { display:inline-block; vertical-align:top; padding:5px 10px; border-right:1px solid #ddd; }
.group:last-child { border-right:none; }
button.icon {
  font-family:'IcoMoon';
  font-size:20px;
  background:none;
  border:none;
  cursor:pointer;
  margin:5px;
  transition:background 0.2s;
}
button.icon:hover { background:#e6eaf2; border-radius:6px; }

/* Editor/Table */
#table-editor {
  flex-grow:1;
  background:#fff;
  margin:0;
  padding:20px;
  overflow:auto;
}
table.sheet{
  border-collapse:collapse;
  width:100%;
  min-width:700px;
}
table.sheet th, table.sheet td{
  border:1px solid #ccc;
  padding:8px 10px;
  min-width:80px;
  vertical-align:top;
}
table.sheet td[contenteditable="true"]{outline:none; cursor:text;}
td.selected { box-shadow:inset 0 0 0 2px rgba(59,130,246,0.18); background:rgba(59,130,246,0.04); }
</style>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@300;400;600&family=Roboto&display=swap" rel="stylesheet">
</head>

<body>

<div class="ribbon">
  <div class="tabs">
    <div class="tab active" data-tab="file">Datei</div>
    <div class="tab" data-tab="text">Text</div>
    <div class="tab" data-tab="table">Tabelle</div>
  </div>

 <!-- Datei Tab -->
<div class="tab-content active" id="file">
  <div class="group">
    <button class="icon" onclick="downloadOcttb()">&#xe900;</button> 
    <button class="icon" onclick="openOcttb()">&#xe901;</button> 
    <button class="icon" onclick="exportCSV()">&#xe902;</button>
  </div>
</div>

<!-- Text Tab -->
<div class="tab-content" id="text">
  <div class="group">
    <button class="icon" onclick="exec('bold')">&#xe910;</button>
    <button class="icon" onclick="exec('italic')">&#xe911;</button>
    <button class="icon" onclick="exec('underline')">&#xe912;</button>
    <select id="fontSelect">
      <option>Arial</option>
      <option>Bahnschrift</option>
      <option>Bungee</option>
      <option>Calibri</option>
      <option>Comic Sans MS</option>
      <option>LukovicSans</option>
      <option>RetroStylePro</option>
      <option>SegoeUI</option>
      <option>Work Sans</option>
      <option>Playfair Display</option>
      <option>Noto Sans</option>
      <option>Verdana</option>
      <option>Georgia</option>
      <option>Signika</option>
    </select>
    <select id="fontSize">
      <option>10</option><option>12</option><option>14</option><option>16</option>
      <option>18</option><option>20</option><option>24</option><option>28</option>
    </select>
    <input type="color" id="colorPicker" title="Textfarbe">
  </div>
</div>

<!-- Tabelle Tab -->
<div class="tab-content" id="table">
  <div class="group">
    <button class="icon" onclick="addRow()">&#xe920;</button> <!-- Zeile hinzufügen -->
    <button class="icon" onclick="addCol()">&#xe921;</button> <!-- Spalte hinzufügen -->
    <button class="icon" onclick="delRow()">&#xe922;</button> <!-- Zeile löschen -->
    <button class="icon" onclick="delCol()">&#xe923;</button> <!-- Spalte löschen -->
    <button class="icon" onclick="mergeCells()">&#xe924;</button> <!-- Zellen verbinden -->
    <button class="icon" onclick="splitCell()">&#xe925;</button> <!-- Zelle teilen -->
  </div>
</div>

</div>

<!-- Table Editor -->
<div id="table-editor">
  <table class="sheet" id="sheet">
    <thead>
      <tr><th>A</th><th>B</th><th>C</th><th>D</th></tr>
    </thead>
    <tbody>
      <tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr>
      <tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr>
    </tbody>
  </table>
</div>

<input type="file" id="fileInput" accept=".octtb,.csv" hidden>

<script>
// --- Tab Switching ---
const tabs = document.querySelectorAll('.tab');
tabs.forEach(tab => tab.addEventListener('click', () => {
  tabs.forEach(t=>t.classList.remove('active'));
  document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
  tab.classList.add('active');
  document.getElementById(tab.dataset.tab).classList.add('active');
}));

// --- Text Formatting ---
function exec(cmd,val=null){ document.execCommand(cmd,false,val); }
document.getElementById('fontSelect').onchange=e=>exec('fontName',e.target.value);
document.getElementById('fontSize').onchange=e=>exec('fontSize',e.target.value);
document.getElementById('colorPicker').onchange=e=>exec('foreColor',e.target.value);

// --- Table Functions ---
const sheet = document.getElementById('sheet');
const MAX_COL = 2233; // FS823 ~ A..Z..AA..FS823
function getColumnName(n){let name="";while(n>0){n--;name=String.fromCharCode(65+(n%26))+name;n=Math.floor(n/26);}return name;}
function addRow(){const cols=sheet.tHead.rows[0].cells.length; const row=sheet.tBodies[0].insertRow(); for(let i=0;i<cols;i++){const td=row.insertCell(); td.contentEditable='true';}}
function addCol(){const cols=sheet.tHead.rows[0].cells.length; if(cols>=MAX_COL) return alert('Maximale Spaltenanzahl erreicht!'); const th=document.createElement('th'); th.textContent=getColumnName(cols+1); sheet.tHead.rows[0].appendChild(th); [...sheet.tBodies[0].rows].forEach(r=>{ const td=r.insertCell(); td.contentEditable='true';});}
function delRow(){ if(sheet.tBodies[0].rows.length>1) sheet.tBodies[0].deleteRow(-1); }
function delCol(){ const cols=sheet.tHead.rows[0].cells.length; if(cols>1){ sheet.tHead.rows[0].deleteCell(-1); [...sheet.tBodies[0].rows].forEach(r=>r.deleteCell(-1)); } }
function mergeCells(){ const sel=window.getSelection(); if(!sel.rangeCount) return; const td=sel.anchorNode?.parentElement.closest('td'); const next=td?.nextElementSibling; if(td && next){ td.colSpan=(td.colSpan||1)+(next.colSpan||1); td.innerHTML+=next.innerHTML; next.remove(); } }
function splitCell(){ const sel=window.getSelection(); if(!sel.rangeCount) return; const td=sel.anchorNode?.parentElement.closest('td'); if(td && td.colSpan>1){ const cols=td.colSpan; td.colSpan=1; for(let i=1;i<cols;i++){ const n=td.parentElement.insertCell(td.cellIndex+1); n.contentEditable='true'; } } }

// --- File Save/Load (.octtb) ---
function downloadOcttb(){ const blob=new Blob([sheet.tBodies[0].innerHTML], {type:'text/plain'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='tabelle.octtb'; a.click(); setTimeout(()=>URL.revokeObjectURL(a.href),2000);}
function openOcttb(){ const fileInput=document.getElementById('fileInput'); fileInput.click(); fileInput.onchange=e=>{ const f=e.target.files[0]; if(!f) return; const reader=new FileReader(); reader.onload=ev=>sheet.tBodies[0].innerHTML=ev.target.result; reader.readAsText(f); };}

// --- CSV Export ---
function exportCSV(){ let csv=''; [...sheet.rows].forEach(r=>{ const cells=[...r.cells].map(c=>`"${c.innerText.replace(/"/g,'""')}"`); csv+=cells.join(';')+'\n';}); const blob=new Blob([csv],{type:'text/csv'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='tabelle.csv'; a.click(); setTimeout(()=>URL.revokeObjectURL(a.href),2000);}
</script>

</body>
</html>
