<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mini-Kicker</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f4f4;
  margin: 0;
}
header, footer {
  text-align: center;
  background: #222;
  color: #fff;
  padding: 1rem;
}
main {
  max-width: 900px;
  margin: auto;
  padding: 1rem;
}
h1 { margin: 0; }
table {
  width: 100%;
  border-collapse: collapse;
  background: #fff;
  margin-bottom: 2rem;
}
table th, table td {
  border: 1px solid #ccc;
  padding: .4rem;
  text-align: center;
}
table tbody tr:nth-child(even) { background: #eee; }
#matches { list-style: none; padding: 0; }
#matches li {
  background: #fff;
  border: 1px solid #ccc;
  margin-bottom: .5rem;
  padding: .6rem;
}
</style>
</head>
<body>
<header>
  <h1>⚽ Mini-Kicker</h1>
  <p>Live-Tabelle & nächste Spiele der Bundesliga</p>
</header>

<main>
  <section>
    <h2>Tabelle</h2>
    <table id="table">
      <thead>
        <tr>
          <th>#</th><th>Team</th><th>Sp</th><th>G</th><th>U</th><th>V</th>
          <th>Tore</th><th>Diff</th><th>Pkt</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <section>
    <h2>Nächste Spiele</h2>
    <ul id="matches"></ul>
  </section>
</main>

<footer>
  <small>Daten: openligadb.de (frei zugänglich)</small>
</footer>

<script>
const season = new Date().getFullYear();
const league = "bl1";

async function loadTable() {
  const r = await fetch(`https://www.openligadb.de/api/getbltable/${league}/${season}`);
  const d = await r.json();
  const body = document.querySelector("#table tbody");
  body.innerHTML = "";
  d.forEach((t,i) => body.insertAdjacentHTML("beforeend", `
    <tr>
      <td>${i+1}</td>
      <td>${t.TeamName}</td>
      <td>${t.Matches}</td>
      <td>${t.Won}</td>
      <td>${t.Draw}</td>
      <td>${t.Lost}</td>
      <td>${t.Goals}:${t.OpponentGoals}</td>
      <td>${t.GoalDiff}</td>
      <td>${t.Points}</td>
    </tr>`));
}

async function loadMatches() {
  const r = await fetch(`https://www.openligadb.de/api/getmatchdata/${league}/${season}`);
  const d = await r.json();
  const upcoming = d.filter(m => !m.MatchResults?.length)
                    .sort((a,b)=> new Date(a.MatchDateTimeUTC)-new Date(b.MatchDateTimeUTC))
                    .slice(0,10);
  const list = document.getElementById("matches");
  list.innerHTML = "";
  upcoming.forEach(m=>{
    const dt = new Date(m.MatchDateTimeUTC+"Z").toLocaleString(
      "de-DE",
      {timeZone:"Europe/Berlin",weekday:"short",day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}
    );
    list.insertAdjacentHTML("beforeend",
      `<li>${dt}: ${m.Team1.TeamName} – ${m.Team2.TeamName}</li>`);
  });
}

loadTable();
loadMatches();
setInterval(()=>{loadTable();loadMatches();}, 300000);
</script>
</body>
</html>

